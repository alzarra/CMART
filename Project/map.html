<!DOCTYPE html>
<html>
<head>
	<title>Montana Recycle - Map</title>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="style.css">

<style>
  h10 {
    text-align: center;
    font-size: 50px;
    line-height: 5px;
  }
  .fix-me {
  /*position: fixed;*/
  /*top:60%;*/
  /* bottom: 5%;*/
  /*left: 15%;*/
  height: 14.5%;
  width: 78.6%;
  /*border: 1px solid blue;*/
  padding: 10px;
  font-size: 14px;
  /*background-color: white;*/
  margin-left: 21%;
  background-color: #aed6f1;
  border: 5px solid rgb(244, 160, 36);
  padding: -5px;

}

</style>


<body>
<!-- logo -->
<img src='pictures/MR.png' alt='logo' style="width:250px;">
<img src='pictures/05_DEQLogo_TransparentBG_Web.png' alt='logo' style="float:right;">

<!-- nav bar -->
  <ul>
    <li><a clas = 'active' href = "index.html">Home</a></li>
    <li><a href = 'map.html' > Map</a></li>
    <li><a href = 'FAQ.html' > FAQ </a></li>
    <li><a href = 'contact.html' > Contact Us</a></li>
    <li><a href = 'about.html' > About Us</a></li>
    <li><a href = 'stats.html' > Recycling Statistics</a></li>
    <li2><a href = 'signup.html' > Login/Sign Up</a></li>
  </ul>

<!-- tital bar -->

<div class="grid-container" style="border-radius: 30px 30px 30px 30px;">
    <div class="item1">
            
              <h10>Recycle Montana Map</h10>
    </div>
    <div class="item2" style="height:775px; margin-left: -5px; margin-top: 5px; margin-right: -5px;  border-radius: 0px; border-radius: 0px 0px 30px 30px;"  >


<!-- side search bar -->

<div id="mySidenav" class="item2" style="font-size: 15px; width: 215px; margin-top: -23px; margin-left: -25px; height: 96%; border-radius: 0px 0px 0px 30px; ">
  <!-- <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a> -->
  
  <b>Recyclable Materials:</b><br><br><br>
    
    <!--  script to secelect all -->
    <script type="text/javascript">
      $('#select-all').click(function(event) {   
    if(this.checked) {
        // Iterate each checkbox
        $(':checkbox').each(function() {
            this.checked = true;
            console.log("select-all")                        
        });
    } else {
        $(':checkbox').each(function() {
            this.checked = false;                       
        });
    }
});
    </script>
    
    <!-- <input type="checkbox" name="select-all" id="select-all" class='chk-btn'>
    <label for='all'>Show all</label>
    <br><br> -->
    <input type="checkbox" name="filter" id="Plastic" class='chk-btn'>
    <label for='Plastic'>Plastic</label>
    <br><br><br>
    <input type="checkbox" name="filter" id="Batteries" class='chk-btn'>
    <label for='Batteries'>Batteries</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Metal" class='chk-btn'>
    <label for='Metal'>Metal</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Cardboard" class='chk-btn'>
    <label for='Cardboard'>Cardboard</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Paper" class='chk-btn'>
    <label for='Paper'>Paper</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Glass" class='chk-btn'>
    <label for='Glass'>Glass</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Plastic_Bags_Film_Wrap" class='chk-btn'>
    <label for='Plastic_Bags_Film_Wrap'>Plastic Bags/Film/Wrap</label>
<br><br><br>
    <input type="checkbox" name="filter" id="CFLs_and_Tubes" class='chk-btn'>
    <label for='CFLs_and_Tubes'>CFLs & Tubes</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Wood_and_Lawn_Waste__Kitchen_Compost" class='chk-btn'>
    <label for='Wood_and_Lawn_Waste__Kitchen_Compost' style="font-size: 10px">Wood & Lawn Waste/Kitchen Compost</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Cooking_Oil" class='chk-btn'>
    <label for='Cooking_Oil'>Cooking Oil</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Electronics" class='chk-btn'>
    <label for='Electronics'>Electronics</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Automotive_Fluids_and_Waste_Water" class='chk-btn'>
    <label for='Automotive_Fluids_and_Waste_Water' style="font-size: 11px">Automotive Fluids & Waste Water</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Tires" class='chk-btn'>
    <label for='Tires'>Tires</label>
<br><br><br>
    <input type="checkbox" name="filter" id="Vehicles" class='chk-btn'>
    <label for='Vehicles'>Vehicles</label>




  	<!-- <input id="KoM" class="checkbox" name="all" value="all"> <br>
  	<input id="KoM" class="checkbox" name="Plastic" value="Plastic"> <br>
  	<input id="KoM" class="checkbox" name="Batteries" value="Batteries"> <br>
  	<input id="KoM" class="checkbox" name="Metal" value="Metal"> <br>
  	<input id="KoM" class="checkbox" name="Cardboard" value="Cardboard"> <br>
  	<input id="KoM" class="checkbox" name="Paper" value="Paper"> <br>
  	<input id="KoM" class="checkbox" name="Glass" value="Glass"> <br>
  	<input id="KoM" class="checkbox" name="Plastic Bags/Film/Wrap" value="Plastic Bags/Film/Wrap"> <br>
  	<input id="KoM" class="checkbox" name="CFLs & Tubes" value="CFLs & Tubes"> <br>
  	<input id="KoM" class="checkbox" name="Wood & Lawn Waste/Kitchen Compost" value="Wood & Lawn Waste/Kitchen Compost"> <br>
  	<input id="KoM" class="checkbox" name="Cooking Oil" value="Cooking Oil"> <br>
  	<input id="KoM" class="checkbox" name="Electronics" value="Electronics"> <br>
  	<input id="KoM" class="checkbox" name="Automotive Fluids & Waste Water" value="Automotive Fluids & Waste Water"> <br>
  	<input id="KoM" class="checkbox" name="Tires" value="Tires"> <br>
  	<input id="KoM" class="checkbox" name="Vehicles" value="Vehicles"> <br> -->

  	<br>
  
  <!--<br><br><br><b>Range:</b><br><br><br>
  <form action="/action_page.php"
	oninput="x.value=parseInt(a.value)+parseInt(b.value)" color = 'white' style="margin-left: 50px">
	  0
	  <input type="range" min='1' max='100' value='50' id= 'myRange' clase='slider' style="margin-right: 50px">
	  100
    <br>
    <div>Value: <div id='demo'></div></div>
   </form>
   <br>
   <br>
   <br> -->
</div>


<!-- <span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; Filter</span>

<script>
function openNav() {
    document.getElementById("mySidenav").style.width = "360px";
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
}

// for slider 
var slider = document.getElementById("myRange");
var output = document.getElementById("demo");
output.innerHTML = slider.value;

slider.oninput = function(){
  output.innerHTML = this.value
}
</script> -->


<div id="map" class="item2" style="width: 76.3%; margin-top: -830px; margin-left: 278px;  border-radius: 0px 0px 0px 0px; height: 75%;"></div>

 <script>

  var filters = {Paper:false, Glass:false, Plastic:false, Batteries:false, Metal:false, Carboard:false, Plastic_Bags_Film_Wrap:false, CFLs_and_Tubes:false, Wood_and_Lawn_Waste_Kitchen_Compost:false, Cooking_Oil:false, Electronics:false, Automotive_Fluids_and_Waste_Water: false, Tires:false, Vehicles:false}

  ///filter function////
  $(function () {
    $('input[name=filter]').change(function (e) {
      console.log(this.id)
     map_filter(this.id);
      filter_markers()
  });


})

var get_set_options = function() {
  ret_array = []
  for (option in filters) {
    if (filters[option]) {
      ret_array.push(option)
    }
  }
  return ret_array;
}

var filter_markers = function() {  
  set_filters = get_set_options()
  
  // for each marker, check to see if all required options are set
  for (i = 0; i < markers.length; i++) {
    marker = markers[i];

    // start the filter check assuming the marker will be displayed
    // if any of the required features are missing, set 'keep' to false
    // to discard this marker
    keep= false 
    for (opt=0; opt<set_filters.length; opt++) {
      //console.log(marker.properties[set_filters[opt]])
      if (marker.properties[set_filters[opt]]) {
        //console.log("hi there")
        keep = true;
      }
    }
    marker.setVisible(keep)
  }
}

var map_filter = function(id_val) {
  //console.log(filters[id_val])
   if (filters[id_val]) 
      filters[id_val] = false
   else
      filters[id_val] = true
}


// after the geojson is loaded, iterate through the map data to create markers
// and add the pop up (info) windows
function loadMarkers() {
  console.log('creating markers')
  var infoWindow = new google.maps.InfoWindow()
  geojson_url = 'https://raw.githubusercontent.com/alzarra/Montana-Recycle/master/RB.geojson'
  $.getJSON(geojson_url, function(result) {
      // Post select to url.
      data = result['features']
      $.each(data, function(key, val) {
        var point = new google.maps.LatLng(
                parseFloat(val['geometry']['coordinates'][1]),
                parseFloat(val['geometry']['coordinates'][0]));
        var titleText = val['properties']['Recycler']
        //recyling materiales 
        var descriptionText = val['properties']['Description']
        
        var websiteText = val['properties']['Link']
        var noteText = val['properties']['Note']
        var townText = val['properties']['Town']
        var marker = new google.maps.Marker({
          position: point,
          title: titleText,
          map: map,
          properties: val['properties']
         });

        //info box 
        var markerInfo = "<div><h3>" + titleText
                      + "</h3>Town: " +  townText
                      + "<br></h3>Recycling: " + descriptionText   
                      + "<br></h3>Website: "+ websiteText
                      + "<br></h3>Note: "+ noteText
                      +"</div>"


        marker.addListener('click', function() {
           $('#location_info').html(markerInfo)
        });
        markers.push(marker)
        
      });
  });
}
/////////end filter/////////////////
    // Note: This example requires that you consent to location sharing when
    // prompted by your browser. If you see the error "The Geolocation service
    // failed.", it means you probably did not give permission for the browser to
    // locate you.
    var map, infoWindow
    var markers = [] //marker;
    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 46.8797, lng: -110.3626},
            zoom: 7,
            visibility: 'false',
            disableDefaultUI: false,     // to show the UI of the map
            scrollwheel: true,    // to use scroll wheel for zooming
            draggable: true,     // to allow the user to drag the map with mouse
            //mapTypeId: google.maps.MapTypId.ROADMAP    // setting the map type, like (hyperd, sattliat, roadmap) now leave it for defult
            maxZoom: 15, // set the max zoom to 15 to cover the city but not all around
            minZoom: 9,  // set the min zoom to 9 so the user don't get confuse and go to another county 
            // setting the zoom control style and postion
            zoomControlOptions: {
              position: google.maps.ControlPosition.TOP_RIGHT,
              //style: google.maps.ZoomControlStyle.DEFAULT

            }


        });
        loadMarkers()




        infoWindow = new google.maps.InfoWindow;

        // Try HTML5 geolocation.

        if (navigator.geolocation) {
          var global_pos ={
                  lat: 5,
                  lng: 5}
            navigator.geolocation.getCurrentPosition(function(position) {
              var pos = {
                  lat: position.coords.latitude,
                  lng: position.coords.longitude
              };
              global_pos = pos;
              console.log(global_pos);

                          console.log("Start Draw");
            //drawing range circle 
            var Range_circle = new google.maps.Circle({
              strokeColor: '#FF0000',
              strokeOpacity: 0.8,
              strokeWeight: 2,
              fillColor: '#FF0000',
              fillOpacity: 0.35,
              map: map,
              center: global_pos,
              radius: Math.sqrt(100) * 50
            });

                

      

            infoWindow.setPosition(pos);
            infoWindow.setContent('Your location');
            infoWindow.open(map);
            map.setCenter(pos);
            map.setZoom(12);
            }, function() {
              handleLocationError(true, infoWindow, map.getCenter());
            });


        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }

        // // HIGHLIGHING MONTNANA

         // Define the LatLng coordinates for the polygon's  outer path.
        var outerCoords = [
          {lat: 66.08936427047088, lng: -25.48828125},
          {lat: 66.16051056018838, lng: -183.691406255},
          {lat: -14.604847155053898, lng: -187.03125},
          {lat: -7.18810087117902, lng: -32.51953125},
          {lat: 66.08936427047088, lng: -25.48828125}

          

          
        ];

        // Define the LatLng coordinates for the polygon's inner path.
        // Note that the points forming the inner path are wound in the
        // opposite direction to those in the outer path, to form the hole.
        var innerCoords = [
          {lat: 48.99463598353405, lng: -104.04052734375},
          {lat: 44.98034238084973, lng:-104.04052734375},
          {lat: 44.99588261816546, lng: -111.07177734375},
          {lat: 44.449467536006935, lng: -111.02783203125},
          {lat: 44.715513732021336, lng: -111.4013671875},
          {lat: 44.715513732021336, lng: -111.4013671875},
          {lat: 44.49650533109348, lng:-112.19238281249999 },
          {lat: 44.402391829093915, lng: -112.8515625},
          {lat: 44.793530904744074, lng: -113.26904296874999},
          {lat: 45.24395342262324 , lng: -113.64257812499999},
          {lat: 45.644768217751924, lng: -113.92822265625},
          {lat: 45.42929873257377 , lng: -114.32373046875},
          {lat: 45.62940492064501, lng: -114.521484375},
          {lat: 46.01222384063236, lng: -114.43359375},
          {lat: 46.36209301204985, lng: -114.41162109375},
          {lat: 46.63435070293566, lng: -114.36767578124999},
          {lat: 46.73986059969267, lng: -114.67529296874999}, 
          {lat: 47.27922900257082, lng: -115.42236328124999},
          {lat: 47.502358951968574, lng: -115.7080078125},
         {lat: 47.70976154266637, lng: -115.7080078125}, 
         {lat: 47.931066347509784, lng: -115.94970703125},
         {lat: 47.97705279557946, lng: -116.0430908203125},
          {lat: 49.001843917978526, lng: -116.0540771484375},
   
          {lat: 48.99463598353405, lng: -104.04052734375}

        ];

        // Construct the polygon
        var Montana_Map_out = new google.maps.Polygon({
          paths: [outerCoords, innerCoords],
          strokeColor: '#00000',
          strokeOpacity: 1,
          strokeWeight: 5,
          fillColor: '#00000',
          fillOpacity: .5
        });
       
        Montana_Map_out.setMap(map);
       
////////////////////////////////////////////////////

// range circle

if (navigator.geolocation) {
  var Range_circle = new google.maps.Circle({
              strokeColor: '#FF0000',
              strokeOpacity: 0.8,
              strokeWeight: 2,
              fillColor: '#FF0000',
              fillOpacity: 0.35,
              map: map,
              center: {lat: 49.25, lng: -123.1},
              radius: Math.sqrt(100) * 1000
            });

      Range_circle.setMap(map);
    }

/////////////////////////////////////////////////////

     //    /*
     //    // Add marker
      // var marker = new google.maps.Marker({
     //     position: {lat: 46.851446,lng: -114.012625},
     //     map: map,
     //     icon: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'
          
      // });
      // var infoWindow1 = new google.maps.InfoWindow({
      //  content: 'Batteries Plus Bulbs:<br> Batteries, CFLs & Tubes'
      // });

      // marker.addListener('click', function(){
      //  infoWindow1.open(map, marker);
      // });
      // */
      // // Batteries Plus Bulbs : Batteries Plus Bulbs:<br> Batteries, CFLs & Tubes 
      // addMarker({coords:{lat: 46.851446,lng: -114.012625},  content: 'Batteries Plus Bulbs : <br>Batteries, CFLs & Tubes'});
      // // Bayern Brewing Inc : Batteries, CFLs & Tubes
      // addMarker({coords:{lat: 46.872641,lng: -114.020211}, content: 'Bayern Brewing Inc : <br>Batteries, CFLs & Tubes'});
      // // Best Buy : Electronics
      // addMarker({coords:{lat: 46.889230,lng: -114.037012}, content: 'Best Buy : <br>Electronics'});
      // // Emerald Services : Automotive Fluids & Waste Water
      // addMarker({coords:{lat: 46.880620,lng: -114.002600}, content: 'Emerald Services : <br>Automotive Fluids & Waste Water'});
      // // Garden City Recycling : Metal, Cardboard, Paper, Glass (Bayern Eco Pacs), Plastic
      // // no physical location
      // // Home Depot: Batteries, CFLs
      // addMarker({coords:{lat: 46.889920,lng: -114.044634}, content: 'Home Depot: <br>Batteries, CFLs' });
      // //i.e. Recycling: Cardboard, Paper, Glass, Plastic,,Wood & Lawn Waste, Electronics
      // // not in missoula 
      // // JC Penney: Plastic Bags
      // addMarker({coords:{lat: 46.845190,lng: -114.030109}, content: 'JC Penney: <br>Plastic Bags'});
      // //Lowes : Batteries, Plastic Bags, CFLS
      // addMarker({coords:{lat: 46.892964,lng: -114.037458}, content: 'Lowes : <br>Batteries, Plastic Bags, CFLS'});
      // //Missoula County: Vehicles
      // addMarker({coords:{lat: 46.875820,lng: -113.995585}, content: 'Missoula County: <br>Vehicles'});
      // //Missoula Fresh Market: Plastic Bags
      // addMarker({coords:{lat: 46.876121,lng: -114.005345}, content: 'Missoula Fresh Market: <br>Plastic Bags'});
      // //Pacific Steel and Recycling : Batteries, Metal, Cardboard, Paper, Electronics
      // addMarker({coords:{lat: 46.888245,lng: -114.032566}, content: 'Pacific Steel and Recycling : <br>Batteries, Metal, Cardboard, Paper, Electronics'});
      // //Staples : Electronics
      // addMarker({coords:{lat: 46.885492,lng: -114.036634}, content: 'Staples : <br>Electronics'});
      // //Target : Plastic Bags
      // addMarker({coords:{lat: 46.888071,lng: -114.037189}, content: 'Target : <br>Plastic Bags'});
      // //Wal-Mart Supercenter : Plastic Bags //has 2 location
      // addMarker({coords:{lat: 46.831934,lng: -114.047511}, content:'Wal-Mart Supercenter : <br>Plastic Bags'});
      // addMarker({coords:{lat: 46.884144,lng: -114.042075}, content:'Wal-Mart Supercenter : <br>Plastic Bags'});
      // //Axmen Recycling : Batteries, Metal, Electronics, Vehicles
      // addMarker({coords:{lat: 46.942566,lng: -114.133235}, content: 'Axmen Recycling : <br>Batteries, Metal, Electronics, Vehicles'});
      // //P.E.T.E.S., Inc.: Tubes, Electronics
      // addMarker({coords:{lat: 46.842354,lng: -114.038380}, content: 'P.E.T.E.S., Inc.: <br>Tubes, Electronics'});
      // //Republic Services: Republic Services, Metal, Cardboard, Paper, Plastic
      // addMarker({coords:{lat: 46.888991,lng: -114.012687}, content: 'Republic Services: <br>Republic Services, Metal, Cardboard, Paper, Plastic'});

      



      // //find better way to for marker (marker function)
      // function addMarker(props){
      //  var marker = new google.maps.Marker({
     //     position: props.coords,
     //     map: map,
     //     icon: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'
      //  });

      //  // Check content
      //  if(props.content){
      //    var infoWindow1 = new google.maps.InfoWindow({
      //      content: props.content
      //    });
      //    marker.addListener('click', function(){
      //      infoWindow1.open(map, marker);
      //    });

      //  }

      // }
      


    }

    // give error if geolocation faild
    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
      
    

      }


  
    </script>

</script>

</script>
 <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBiL43prKFi1dr_HPrMlL-b16KP_4kRa-c&callback=initMap"
        async defer></script>

<div class="fix-me button"id="location_info" style="width: 80.5%; margin-left: 278px; height: 130.5px; border-radius: 0px 0px 30px 0px;">All Recycled points are show in the map, Please select The recyclable material desired
  <br>
  click on the recycling point to show more infomation about it<div>

</body>
</html>